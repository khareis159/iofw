<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>HyperWeb3 | Faculdade Simbi√≥tica</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #020617; color: #10b981; font-family: monospace; }
        .oesd-card { border: 1px solid #064e3b; background: rgba(6, 78, 59, 0.1); }
        .scanline { border-bottom: 2px solid rgba(16, 185, 129, 0.1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // 1. CONEX√ÉO COM SEU FIREBASE
        const firebaseConfig = { databaseURL: "https://iofw-79391-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const { useState, useEffect } = React;

        function App() {
            const [input, setInput] = useState("");
            const [stats, setStats] = useState({ rigor: 10, imaginacao: 10, simbiose: 10 });
            const [chat, setChat] = useState([{ role: 'assistant', content: 'Sauda√ß√µes, acad√™mico. Eu sou o Tutor Simbi√≥tico. Qual problema do mundo real iremos transmutar hoje usando a OESD?' }]);
            const [loading, setLoading] = useState(false);

            // SUA CHAVE DA IA (Cole aqui a chave do Passo 2)
            const GROQ_KEY = "COLE_AQUI_SUA_CHAVE_GSK"; 

            // Sincronizar stats com o Firebase em tempo real
            useEffect(() => {
                db.ref('aluno_teste/stats').on('value', (snapshot) => {
                    if (snapshot.val()) setStats(snapshot.val());
                });
            }, []);

            const processarOESD = async () => {
                if(!input || !GROQ_KEY.includes("gsk")) {
                    alert("Por favor, insira sua chave da Groq no c√≥digo!");
                    return;
                }
                setLoading(true);
                const novasMensagens = [...chat, { role: 'user', content: input }];
                setChat(novasMensagens);
                setInput("");

                try {
                    const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                        method: "POST",
                        headers: { "Authorization": `Bearer ${GROQ_KEY}`, "Content-Type": "application/json" },
                        body: JSON.stringify({
                            model: "llama3-8b-8192",
                            messages: [
                                { role: "system", content: "Voc√™ √© o Tutor da Faculdade Simbi√≥tica. Use a Ordem Epistemol√≥gica de Simbiose Digital (OESD). Analise o projeto do aluno sob 4 pilares: Simbiose, Heur√≠stica, Rigor e Imagina√ß√£o. Seja breve e encorajador." },
                                ...novasMensagens
                            ]
                        })
                    });
                    const data = await response.json();
                    const respostaIA = data.choices[0].message.content;
                    
                    setChat([...novasMensagens, { role: 'assistant', content: respostaIA }]);

                    // Evoluir Stats no Firebase
                    const novosStats = {
                        rigor: Math.min(stats.rigor + 5, 100),
                        imaginacao: Math.min(stats.imaginacao + 8, 100),
                        simbiose: Math.min(stats.simbiose + 6, 100)
                    };
                    db.ref('aluno_teste/stats').set(novosStats);
                } catch (e) {
                    console.error("Erro na IA:", e);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="max-w-4xl mx-auto p-6">
                    <header className="border-b border-emerald-800 mb-8 pb-4 flex justify-between items-end">
                        <div>
                            <h1 className="text-3xl font-bold tracking-widest text-emerald-400">HYPERWEB3 // OESD</h1>
                            <p className="text-[10px] text-emerald-700">INSTITUI√á√ÉO EDUCACIONAL DESCENTRALIZADA</p>
                        </div>
                        <div className="text-right text-xs space-y-1">
                            <div>RIGOR: {stats.rigor}%</div>
                            <div>IMAGINA√á√ÉO: {stats.imaginacao}%</div>
                            <div className="text-violet-400 font-bold">SIMBIOSE: {stats.simbiose}%</div>
                        </div>
                    </header>

                    <main className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div className="md:col-span-2 flex flex-col h-[600px] oesd-card rounded-lg p-4">
                            <div className="flex-1 overflow-y-auto space-y-4 mb-4 text-sm p-2">
                                {chat.map((m, i) => (
                                    <div key={i} className={`p-3 rounded ${m.role === 'user' ? 'bg-emerald-900/30 ml-8 border-r-2 border-emerald-500' : 'bg-slate-900/50 mr-8 border-l-2 border-violet-500'}`}>
                                        <p className="text-[10px] opacity-50 mb-1">{m.role.toUpperCase()}</p>
                                        {m.content}
                                    </div>
                                ))}
                                {loading && <div className="animate-pulse">IA Processando Simbiose...</div>}
                            </div>
                            <div className="flex gap-2 border-t border-emerald-900 pt-4">
                                <input 
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    className="flex-1 bg-black border border-emerald-900 p-3 outline-none focus:border-emerald-400 text-emerald-400"
                                    placeholder="Descreva sua ideia de projeto..."
                                />
                                <button onClick={processarOESD} className="bg-emerald-600 text-black px-6 font-bold hover:bg-emerald-400 transition">INICIAR</button>
                            </div>
                        </div>

                        <div className="space-y-6">
                            <div className="oesd-card p-4 rounded-lg">
                                <h3 className="text-xs font-bold mb-4 border-b border-emerald-900 pb-2">LEGADO (NFT)</h3>
                                {stats.simbiose > 50 ? (
                                    <div className="text-center p-4 border-2 border-dashed border-violet-500 animate-bounce">
                                        <p className="text-[10px]">NFT DISPON√çVEL</p>
                                        <button className="bg-violet-600 text-white text-[10px] p-2 mt-2">FORJAR CERTIFICADO</button>
                                    </div>
                                ) : (
                                    <p className="text-[10px] opacity-30 italic text-center">Atinja 50% de Simbiose para gerar seu Legado Vivo.</p>
                                )}
                            </div>
                            
                            <div className="oesd-card p-4 rounded-lg">
                                <h3 className="text-xs font-bold mb-4 border-b border-emerald-900 pb-2">PILARES OESD</h3>
                                <ul className="text-[10px] space-y-2">
                                    <li>üå± SIMBIOSE COGNITIVA</li>
                                    <li>üõ†Ô∏è APLICA√á√ÉO HEUR√çSTICA</li>
                                    <li>üî¨ RIGOR COM IMAGINA√á√ÉO</li>
                                    <li>üìú HIST√ìRIA VIVA</li>
                                </ul>
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
